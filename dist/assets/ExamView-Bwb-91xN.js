import{d as j,u as V,l as S,m as h,w as P,h as D,p as F,c as o,i as t,q as u,s as k,n as g,t as l,k as H,F as G,j as U,o as i}from"./vue-BoVV1TXU.js";import{u as J}from"./question-BHdgvkCv.js";import{_ as K}from"./index-fMt_0IbP.js";import"./lodash-CqkleIqs.js";const W=j({__name:"ExamView",setup(I,{expose:a}){a();const r=J(),e=V(),c=S(""),x=S(!1),f=S(!1),v=h(()=>r.currentChapter),m=h(()=>r.currentQuestionSet),s=h(()=>r.currentQuestion),Q=h(()=>m.value?r.currentQuestionIndex/m.value.questions.length*100:0),w=h(()=>m.value?r.currentQuestionIndex===m.value.questions.length-1:!1),q=h(()=>s.value?r.getQuestionCorrectRate(s.value.id):0);P(s,()=>{c.value="",x.value=!1});function b(n){n.preventDefault(),c.value&&(w.value?y():C())}D(()=>{window.addEventListener("contextmenu",b)}),F(()=>{window.removeEventListener("contextmenu",b)});function N(n){var d;if(c.value){n===((d=s.value)==null?void 0:d.correctOptionId)&&(w.value?y():C());return}c.value=n,s.value&&(x.value=n===s.value.correctOptionId,r.recordAnswer(s.value.id,n,x.value))}function E(n){var d;return c.value?n===((d=s.value)==null?void 0:d.correctOptionId)?"border-green-500 bg-green-50":n===c.value?"border-red-500 bg-red-50":"border-gray-200 opacity-70":"hover:bg-gray-50 border-gray-200"}function A(n){var d;return c.value?n===((d=s.value)==null?void 0:d.correctOptionId)?"bg-green-500 text-white":n===c.value?"bg-red-500 text-white":"bg-gray-200 text-gray-700":"bg-gray-200 text-gray-700"}function R(){if(!s.value)return"";const n=s.value.options.find(d=>{var _;return d.id===((_=s.value)==null?void 0:_.correctOptionId)});return n?n.text:""}function C(){c.value="",x.value=!1,r.moveToNextQuestion()}function y(){var d;console.log("完成题集开始，当前章节:",r.currentChapterId,"当前题集:",r.currentQuestionSetId);const n=r.isCurrentSetAllCorrect&&r.isCurrentSetAllCorrect();if(console.log("当前题集是否全部做对:",n),n){const _=r.getNextQuestionSet();console.log("下一个题集信息:",_);const p=r.moveToNextQuestionSet();console.log("移动到下一个题集结果:",p),p.success&&!p.reset?(c.value="",x.value=!1,console.log("全部做对，进入下一个题集:",(d=r.currentQuestionSet)==null?void 0:d.title)):(r.resetCurrentSetProgress(),c.value="",x.value=!1,console.log("已完成所有题集，重新开始当前题集"))}else r.resetCurrentSetProgress(),c.value="",x.value=!1,console.log("未全部做对，重新开始当前题集，当前问题索引:",r.currentQuestionIndex);r.currentQuestionIndex!==0&&(console.warn("问题索引未正确重置，强制设置为0"),r.currentQuestionIndex=0),console.log("完成题集结束，当前章节:",r.currentChapterId,"当前题集:",r.currentQuestionSetId,"当前问题索引:",r.currentQuestionIndex)}function z(){e.push("/")}function B(){r.toggleChineseDisplay()}function L(n){return n.toFixed(1)}function M(n){return n===0?"text-gray-500":n<60?"text-red-500":n<80?"text-yellow-500":"text-green-500"}function T(){f.value=!f.value}const O={questionStore:r,router:e,selectedOptionId:c,isCorrect:x,isArticleExpanded:f,currentChapter:v,currentSet:m,currentQuestion:s,progressPercentage:Q,isLastQuestion:w,questionCorrectRate:q,handleContextMenu:b,selectOption:N,getOptionClass:E,getOptionMarkerClass:A,getCorrectOptionText:R,nextQuestion:C,finishQuestionSet:y,goBack:z,toggleChinese:B,formatCorrectRate:L,getCorrectRateClass:M,toggleArticle:T};return Object.defineProperty(O,"__isScriptSetup",{enumerable:!1,value:!0}),O}}),X={class:"max-w-4xl mx-auto min-h-screen w-full p-2 sm:p-4 flex flex-col h-screen"},Y={class:"flex justify-between items-center mb-4 sm:mb-6"},Z={key:0,class:"question-stats px-3 py-1 rounded-full bg-gray-100 text-sm"},$={class:"flex items-center"},ee={key:0,class:"mb-4 sm:mb-6"},te={class:"text-xl sm:text-2xl font-bold mb-2"},re={class:"text-gray-600 text-sm sm:text-base"},se={class:"progress-info flex items-center mt-4"},ne={class:"progress-bar bg-gray-200 h-2 flex-grow rounded-full overflow-hidden"},oe={class:"ml-3 text-sm text-gray-600"},ie={class:""},le={class:"flex-1"},ae={class:"text-xl font-semibold"},ce={key:0,class:"text-lg text-gray-600 mt-1"},de={class:"ml-2 p-1 hover:bg-gray-100 rounded transition-colors flex-shrink-0"},ue={class:"overflow-hidden"},xe={class:"text-base leading-relaxed"},ge={key:0,class:"text-gray-600 mt-4 border-t pt-4 text-base leading-relaxed"},me={key:1,class:"absolute bottom-0 left-0 right-0 h-8 bg-gradient-to-t from-white to-transparent pointer-events-none"},fe={key:1,class:"bg-white rounded-lg shadow-md p-3 sm:p-4 mb-4 flex-grow flex flex-col overflow-hidden min-h-0"},he={class:"text-base sm:text-lg font-medium mb-4 flex-shrink-0"},ve={key:0,class:"text-gray-600 mt-1 text-sm sm:text-base"},_e={class:"flex flex-col gap-2 sm:gap-3 overflow-y-auto"},we=["onClick"],be={class:"flex items-start w-full"},Ce={key:0,class:"text-white text-sm"},ye={key:1,class:"text-white text-sm"},pe={key:2,class:"text-sm font-medium"},Se={class:"flex-1"},ke={class:"text-sm sm:text-base leading-relaxed"},Qe={key:0,class:"text-gray-600 text-xs sm:text-sm mt-1 leading-relaxed"},Oe={key:1,class:"pb-24 flex-shrink-0 overflow-y-auto"},Ie={class:"font-medium"},qe={key:0,class:"mt-2"},Ne={key:1,class:"mt-2"},Ee={class:"flex justify-between fixed bottom-4 left-0 right-0 bg-white p-4 shadow-lg rounded-lg mx-4 z-50"};function Ae(I,a,r,e,c,x){var f,v,m;return i(),o("div",X,[t("div",Y,[t("button",{onClick:e.goBack,class:"back-btn flex items-center text-gray-600 hover:text-gray-900 transition-colors"},a[0]||(a[0]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z","clip-rule":"evenodd"})],-1),k(" 返回 ")])),e.currentQuestion?(i(),o("div",Z,[a[1]||(a[1]=t("span",{class:"text-gray-600"},"正确率: ",-1)),t("span",{class:g([e.getCorrectRateClass(e.questionCorrectRate),"font-medium"])},l(e.formatCorrectRate(e.questionCorrectRate))+"% ",3)])):u("",!0),t("div",$,[a[2]||(a[2]=t("span",{class:"mr-2 text-sm"},"显示中文翻译",-1)),t("button",{onClick:e.toggleChinese,class:g(["toggle-btn w-12 h-6 rounded-full p-1 transition-colors duration-200 ease-in-out",e.questionStore.showChinese?"bg-indigo-600":"bg-gray-300"])},[t("div",{class:g(["toggle-dot bg-white w-4 h-4 rounded-full shadow-md transform duration-200 ease-in-out",e.questionStore.showChinese?"translate-x-6":""])},null,2)],2)])]),e.currentSet?(i(),o("div",ee,[t("h1",te,l((f=e.currentChapter)==null?void 0:f.title)+" - "+l(e.currentSet.title),1),t("p",re,l(e.currentSet.description),1),t("div",se,[t("div",ne,[t("div",{class:"progress-fill bg-indigo-600 h-full",style:H({width:`${e.progressPercentage}%`})},null,4)]),t("span",oe,l(e.questionStore.currentQuestionIndex+1)+" / "+l(e.currentSet.questions.length),1)])])):u("",!0),t("div",ie,[((v=e.currentSet)==null?void 0:v.type)==="reading"&&e.currentSet.article?(i(),o("div",{key:0,class:g(["hidden sm:block mb-4 bg-white rounded-lg shadow-md overflow-hidden transition-all duration-300",{"max-h-96":e.isArticleExpanded,"max-h-24":!e.isArticleExpanded}])},[t("div",{class:"p-4 pb-2 flex justify-between items-start cursor-pointer",onClick:e.toggleArticle},[t("div",le,[t("h2",ae,l(e.currentSet.article.title),1),e.questionStore.showChinese&&e.currentSet.article.titleCN?(i(),o("h3",ce,l(e.currentSet.article.titleCN),1)):u("",!0)]),t("button",de,[(i(),o("svg",{xmlns:"http://www.w3.org/2000/svg",class:g(["h-5 w-5 transform transition-transform duration-300",{"rotate-180":e.isArticleExpanded}]),viewBox:"0 0 20 20",fill:"currentColor"},a[3]||(a[3]=[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"},null,-1)]),2))])]),t("div",ue,[t("div",{class:g(["whitespace-pre-line p-4 pt-0",{"overflow-y-auto max-h-80":e.isArticleExpanded,"overflow-hidden max-h-16 relative":!e.isArticleExpanded}])},[t("p",xe,l(e.currentSet.article.content),1),e.questionStore.showChinese&&e.currentSet.article.contentCN?(i(),o("p",ge,l(e.currentSet.article.contentCN),1)):u("",!0),e.isArticleExpanded?u("",!0):(i(),o("div",me))],2)])],2)):u("",!0),e.currentQuestion?(i(),o("div",fe,[t("div",he,[t("span",null,l(e.currentQuestion.text),1),e.questionStore.showChinese&&e.currentQuestion.textCN?(i(),o("p",ve,l(e.currentQuestion.textCN),1)):u("",!0)]),t("div",_e,[(i(!0),o(G,null,U(e.currentQuestion.options,s=>(i(),o("div",{key:s.id,class:g(["p-3 sm:p-4 border rounded-lg cursor-pointer transition-all duration-200 flex items-center min-h-[3rem] sm:min-h-[3.5rem] hover:border-indigo-500",[e.getOptionClass(s.id),{"hover:border-gray-200":e.selectedOptionId}]]),onClick:Q=>e.selectOption(s.id)},[t("div",be,[t("div",{class:g(["w-6 h-6 rounded-full flex items-center justify-center mr-3 flex-shrink-0 transition-colors duration-200",e.getOptionMarkerClass(s.id)])},[e.selectedOptionId&&s.id===e.currentQuestion.correctOptionId?(i(),o("span",Ce," ✓ ")):e.selectedOptionId&&s.id===e.selectedOptionId&&s.id!==e.currentQuestion.correctOptionId?(i(),o("span",ye," ✗ ")):(i(),o("span",pe,l(s.id.slice(-1)),1))],2),t("div",Se,[t("div",ke,l(s.text),1),e.questionStore.showChinese&&s.textCN?(i(),o("div",Qe,l(s.textCN),1)):u("",!0)])])],10,we))),128))])])):u("",!0)]),e.selectedOptionId?(i(),o("div",Oe,[t("div",{class:g(["result-message p-4 rounded-lg mb-4",e.isCorrect?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},[t("div",Ie,l(e.isCorrect?"回答正确！":"回答错误！"),1),e.isCorrect?u("",!0):(i(),o("div",qe,[a[4]||(a[4]=t("span",{class:"font-medium"},"正确答案：",-1)),k(" "+l(e.getCorrectOptionText()),1)])),(m=e.currentQuestion)!=null&&m.explanation?(i(),o("div",Ne,[a[5]||(a[5]=t("span",{class:"font-medium"},"解析：",-1)),k(" "+l(e.currentQuestion.explanation),1)])):u("",!0)],2),t("div",Ee,[a[6]||(a[6]=t("div",{class:"flex items-center text-gray-500 text-sm"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M10 2a8 8 0 100 16 8 8 0 000-16zM6.5 9a1.5 1.5 0 100-3 1.5 1.5 0 000 3zm7 0a1.5 1.5 0 100-3 1.5 1.5 0 000 3z","clip-rule":"evenodd"})]),t("span",null,"点击鼠标右键进入下一题")],-1)),e.isLastQuestion?(i(),o("button",{key:0,onClick:e.finishQuestionSet,class:"px-3 py-1.5 sm:px-4 sm:py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors text-sm sm:text-base"}," 完成 ")):(i(),o("button",{key:1,onClick:e.nextQuestion,class:"px-3 py-1.5 sm:px-4 sm:py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors text-sm sm:text-base"}," 下一题 "))])])):u("",!0)])}const Me=K(W,[["render",Ae],["__scopeId","data-v-95f81afa"],["__file","D:/ENGLISH_exam/vue3-Ts-Tailwind-template/src/views/ExamView.vue"]]);export{Me as default};
